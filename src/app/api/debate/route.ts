import { NextRequest, NextResponse } from 'next/server'

// 模拟AI辩论响应
const getMockDebateResponse = (question: string): string => {
  const mockResponses: Record<string, string> = {
    '阅读是否应该有明确的目标？': `从反方角度来看，阅读不应该有明确的目标。以下是一些思考角度：\n\n1. **自由探索的价值**：没有明确目标的阅读允许你意外发现新的兴趣和想法，这是有计划阅读无法提供的惊喜。\n\n2. **减少阅读压力**：当阅读带有明确目标时，可能会变成一种任务，失去了阅读本身的乐趣。\n\n3. **培养广泛的知识基础**：无目标阅读可以帮助你建立更广泛的知识网络，这些看似无关的知识在未来可能会产生意想不到的联系。\n\n4. **适应不同的阅读材料**：不同类型的阅读材料有不同的价值，强迫所有阅读都有明确目标可能会忽略某些材料的内在价值。\n\n5. **个人兴趣的自然发展**：跟随兴趣的阅读往往更持久，也更能激发深度思考，而不是被外部目标驱动。\n\n当然，这并不意味着所有阅读都应该没有目标。专业学习、研究等场景下，明确的阅读目标是必要的。关键在于平衡——在不同的阅读情境中选择合适的阅读方式。`,
    '人工智能是否会取代人类工作？': `从反方角度来看，人工智能不会完全取代人类工作。以下是一些思考角度：\n\n1. **人类独特的创造力**：AI可以模仿和生成内容，但真正的原创性、创新性思维仍然是人类的特长。\n\n2. **情感智能的重要性**：许多工作需要情感理解、同理心和人际关系处理能力，这些是AI难以复制的。\n\n3. **工作的本质演变**：历史上技术进步总是改变工作性质，而不是完全消除工作。AI可能会创造新的工作类别。\n\n4. **人类的判断和价值观**：涉及伦理、道德和价值观的决策仍然需要人类的参与。\n\n5. **AI的局限性**：AI依赖于训练数据，在处理未知情境和边缘情况时表现不佳。\n\n6. **人类与AI的协作模式**：未来更可能是人类与AI协作完成工作，而不是AI完全取代人类。\n\n关键在于，我们需要适应AI时代的技能发展，培养那些AI难以复制的人类特质，如创造力、情感智能、批判性思维和道德判断。`,
    '远程工作是否比办公室工作更好？': `从反方角度来看，办公室工作有其独特的优势，并不一定比远程工作差。以下是一些思考角度：\n\n1. **面对面交流的价值**：办公室工作提供了即时、直接的面对面交流机会，有助于建立更牢固的人际关系和团队凝聚力。\n\n2. **工作与生活的边界**：办公室工作可以更好地分离工作和生活，减少工作对个人时间的侵蚀。\n\n3. **学习和成长机会**：在办公室环境中，员工更容易观察和学习同事的工作方式，获得非正式的指导和反馈。\n\n4. **企业文化的建立**：办公室环境更有利于培养和维护企业文化，增强员工的归属感和认同感。\n\n5. **减少居家工作的干扰**：办公室提供了专门的工作环境，减少了家庭环境中的各种干扰。\n\n6. **公平性问题**：远程工作可能加剧数字鸿沟，对那些没有良好居家工作条件的员工不公平。\n\n7. **创新和协作效率**：某些类型的创新和协作（如头脑风暴）在面对面环境中可能更有效。\n\n理想的解决方案可能是混合工作模式，结合两者的优势，根据具体工作性质和个人偏好灵活选择工作地点。`,
  }

  // 如果有匹配的问题，返回对应的模拟响应
  if (mockResponses[question]) {
    return mockResponses[question]
  }

  // 通用模拟响应
  return `从反方角度来看，你的观点有以下值得商榷的地方：\n\n1. **假设的局限性**：你的观点可能基于某些未明确说明的假设，这些假设可能并不总是成立。\n\n2. **视角的单一性**：你可能只考虑了问题的一个方面，而忽略了其他重要的视角。\n\n3. **证据的充分性**：支持你观点的证据可能不够全面或具有选择性。\n\n4. **情境的差异性**：不同情境下，同样的观点可能产生不同的效果，需要具体问题具体分析。\n\n5. **长期影响的忽视**：你可能更多关注了短期效果，而忽视了长期的潜在影响。\n\n6. **价值判断的主观性**：你的观点中可能包含一些主观的价值判断，不同的人可能有不同的看法。\n\n7. **替代方案的可能性**：可能存在其他更优的解决方案或思考方式，值得进一步探索。\n\n通过从这些角度反思你的观点，你可以获得更全面、更深入的理解，从而形成更成熟的判断。`
}

export async function POST(request: NextRequest) {
  try {
    const { question, systemPrompt } = await request.json()

    if (!question || !question.trim()) {
      return NextResponse.json(
        { success: false, error: '问题不能为空' },
        { status: 400 }
      )
    }

    // 模拟API响应，避免真实API调用的成本和限制
    const mockResult = getMockDebateResponse(question)
    
    // 模拟网络延迟，使体验更真实
    await new Promise(resolve => setTimeout(resolve, 1000))

    return NextResponse.json({ success: true, result: mockResult })
  } catch (error) {
    console.error('Debate API error:', error)
    return NextResponse.json(
      { success: false, error: '服务器内部错误' },
      { status: 500 }
    )
  }
}
